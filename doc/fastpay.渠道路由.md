## 渠道路由整体介绍

 渠道路由完成了两个职责
 -  同种支付方式的系统抽象及代理,  对于调用方只需要关注调用的支付方式即可, 不需要关注具体的渠道.
 -  选择哪一个具体支付渠道的决策. (这块是渠道系统设计的重点)
 -  针对不同支付渠道的适配. 可以考虑用独立的服务, 或者在该系统中通过脚本或规则引擎的方式实现.
## 渠道路由需要支持的常用支付方式


    入款: 网银 快捷 扫码  代扣

    出款:

    其他: 卡校验

## 渠道路由的接口设计



## 路由规则

路由规则的条件分为 系统条件和 运营条件
系统必要条件是指如果不满足该条件系统调用会失败.
运营必要条件是指 不满足该条件也能完成支付, 但是从运营规则上不允许使用该通道.

系统条件有:
 -  支付机构   比如用户想用建行支付, 而渠道不支持建设银行.
 -  借记/贷记  比如用户想用借记卡支付, 但渠道只支持贷记卡.
 -  对公/对私
 -  交易限额   不同通道会限制交易的上限和下限，以及针对每个账户的限制(额度/笔数限制. 日限/月限)。超过这个额度，需要变换通道
 -  资金头寸： 电商公司在银行或者第三方平台的资金头寸。如果资金头寸不足，则不能使用这个通道来执行。 只影响出款

运营条件:
 -  费率：费率是路由最重要的一个指标。一般银行是按照额度来收费，部分是按照交易笔数来收费，复杂点的是阶梯收费，比如 10 万一个费率档次，100 万一个费率档次。
 -  到账时效：对于转账，资金什么时候到目标账户上，也是影响路由选择的一个因素。
 -  通道的QOS：掉单率、网络延迟以及接口能支持的 TPS，是路由的一个重要衡量因素。
 -  风险等级: 对于高风险的商户, 不能给他优质通道, 保证优质通道安全.
 -  运营强干预:  对于支付公司, 渠道商户人员可能和银行有相关对赌协议, 所以需要优先路由其通道.

